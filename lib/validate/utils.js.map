{"version":3,"sources":["../../src/validate/utils.js"],"names":["VALIDATE_OPTIONS","abortEarly","convert","noDefaults","improveErrors","error","type","message","replace","addLocation","details","location","map","detail","detailPath","path","Array","join","pathSeperator","length","combineErrorDetails","results","concat","additionalDetails","serversExist","serversConfig","serversUsed","messages","servers","Object","keys","using","forEach","key","indexOf","push","addDepreciation","reason","link"],"mappings":"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","sourcesContent":["export const VALIDATE_OPTIONS = {\n  abortEarly: false,\n  convert: false,\n  noDefaults: true\n};\n\nexport function improveErrors(error) {\n  // Todo: we can configure the joi messages instead of this\n  if (error.type === 'object.allowUnknown') {\n    error.message = error.message.replace(\n      ' is not allowed',\n      ' is an unknown property'\n    );\n  } else if (error.type === 'object.without') {\n    error.message = error.message.replace(\n      ' conflict with forbidden peer ',\n      ' and '\n    );\n    error.message += ' cannot both be defined';\n  } else if (error.type === 'object.min') {\n    error.message = error.message.replace('.value', '');\n  }\n\n  return error;\n}\n\nexport function addLocation(details, location) {\n  return details.map(detail => {\n    const detailPath = detail.path instanceof Array ? detail.path.join('.') : detail.path;\n    const pathSeperator = detailPath.length > 0 ? '.' : '';\n\n    // removes property name from message since it is\n    // already part of detail.path\n    detail.message = detail.message.replace(/^\".*?\"\\s+/, '');\n\n    detail.message = `\"${location}${pathSeperator}${detailPath}\" ${detail.message}`;\n\n    return detail;\n  });\n}\n\nexport function combineErrorDetails(details, results) {\n  if (results instanceof Array) {\n    return details.concat(results);\n  }\n\n  const additionalDetails = results.error ? results.error.details : [];\n\n  return details.concat(additionalDetails);\n}\n\nexport function serversExist(serversConfig = {}, serversUsed = {}) {\n  const messages = [];\n  const servers = Object.keys(serversConfig);\n  const using = Object.keys(serversUsed);\n  using.forEach(key => {\n    if (servers.indexOf(key) === -1) {\n      messages.push({\n        message: `Server \"${key}\" doesn't exist`,\n        path: 'servers'\n      });\n    }\n  });\n\n  return messages;\n}\n\nexport function addDepreciation(details, path, reason, link) {\n  details.push({\n    type: 'depreciation',\n    path,\n    message: `${reason}\\n  Learn more at ${link}`\n  });\n\n  return details;\n}\n"],"file":"utils.js"}