{"version":3,"sources":["../src/swarm-options.js"],"names":["_optionFunctions","registerSwarmOptions","optionFunction","push","mergeLabels","current","additional","reduce","result","label","servers","forEach","server","name","value","getOptions","config","labels","managers","Array"],"mappings":";;;;;;;;;;;;;;;AAAO,MAAMA,gBAAgB,GAAG,EAAzB;;;AAEA,SAASC,oBAAT,CAA8BC,cAA9B,EAA8C;AACnDF,EAAAA,gBAAgB,CAACG,IAAjB,CAAsBD,cAAtB;AACD;;AAED,SAASE,WAAT,CAAqBC,OAArB,EAA8BC,UAA9B,EAA0C;AACxC,SAAOA,UAAU,CAACC,MAAX,CAAkB,CAACC,MAAD,EAASC,KAAT,KAAmB;AAC1CA,IAAAA,KAAK,CAACC,OAAN,CAAcC,OAAd,CAAsBC,MAAM,IAAI;AAC9BJ,MAAAA,MAAM,CAACI,MAAD,CAAN,mCACKJ,MAAM,CAACI,MAAD,CAAN,IAAkB,EADvB;AAEE,SAACH,KAAK,CAACI,IAAP,GAAcJ,KAAK,CAACK;AAFtB;AAID,KALD;AAOA,WAAON,MAAP;AACD,GATM,EASJH,OATI,CAAP;AAUD;;AAEM,SAASU,UAAT,CAAoBC,MAApB,EAA4B;AACjC,SAAOhB,gBAAgB,CAACO,MAAjB,CAAwB,CAACC,MAAD,EAASN,cAAT,KAA4B;AACzD,UAAM;AAAEe,MAAAA,MAAF;AAAUC,MAAAA;AAAV,QAAuBhB,cAAc,CAACc,MAAD,CAAd,IAA0B,EAAvD;;AAEA,QAAIC,MAAM,YAAYE,KAAtB,EAA6B;AAC3BX,MAAAA,MAAM,CAACS,MAAP,GAAgBb,WAAW,CAACI,MAAM,CAACS,MAAR,EAAgBA,MAAhB,CAA3B;AACD;;AAED,QAAIC,QAAJ,EAAc;AACZV,MAAAA,MAAM,CAACU,QAAP,CAAgBf,IAAhB,CAAqB,GAAGe,QAAxB;AACD;;AAED,WAAOV,MAAP;AACD,GAZM,EAYJ;AAAES,IAAAA,MAAM,EAAE,EAAV;AAAcC,IAAAA,QAAQ,EAAE;AAAxB,GAZI,CAAP;AAaD","sourcesContent":["export const _optionFunctions = [];\n\nexport function registerSwarmOptions(optionFunction) {\n  _optionFunctions.push(optionFunction);\n}\n\nfunction mergeLabels(current, additional) {\n  return additional.reduce((result, label) => {\n    label.servers.forEach(server => {\n      result[server] = {\n        ...result[server] || {},\n        [label.name]: label.value\n      };\n    });\n\n    return result;\n  }, current);\n}\n\nexport function getOptions(config) {\n  return _optionFunctions.reduce((result, optionFunction) => {\n    const { labels, managers } = optionFunction(config) || {};\n\n    if (labels instanceof Array) {\n      result.labels = mergeLabels(result.labels, labels);\n    }\n\n    if (managers) {\n      result.managers.push(...managers);\n    }\n\n    return result;\n  }, { labels: {}, managers: [] });\n}\n"],"file":"swarm-options.js"}